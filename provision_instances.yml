- name: Create GCE instance(s)
  hosts: localhost
  connection: local
  gather_facts: no
  roles:
  - gce_provisioner
  vars_files:
  - "{{ config_file }}"
  tags:
  - gce_provisioner

- name: Create AWS instance(s)
  hosts: localhost
  connection: local
  gather_facts: no
  roles:
  - aws_provisioner
  vars_files:
  - "{{ config_file }}"
  tags:
  - aws_provisioner

- name: Create KVM instances
  hosts: localhost
  connection: local
  gather_facts: no
  roles:
  - kvm_provisioner
  vars_files:
  - "{{ config_file }}"
  tags:
  - kvm_provisioner

- name: Provision KVM instances
  hosts: kvm_instances
  roles:
  - kvm
  vars_files:
  - "{{ hostvars['localhost'].config_file }}"
  tags:
  - kvm
