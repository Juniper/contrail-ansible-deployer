---
- name: install openssh tools
  package:
    name: openssh
    state: present

- name: set ssh dir when its undefined
  set_fact:
    ssh_dir: "/etc/contrail/ssh"
  when:
   - ssh_dir is not defined

- name: create ssh directory
  become: yes
  file:
    state: directory
    path: "{{ item.dir }}"
    mode: "{{ item.mode }}"
  with_items:
    - dir: "{{ ssh_dir }}"
      mode: "0700"

- name: generate ssh keys
  shell: ssh-keygen -f {{ ssh_dir }}/id_rsa -t rsa -N ''
  args:
    creates: "{{ ssh_dir }}/id_rsa"
