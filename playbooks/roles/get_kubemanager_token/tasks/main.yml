---
- name: get kubemanager token name from serviceaccount
  shell: kubectl describe sa contrail-kubemanager -n contrail  | grep -i 'Tokens' | awk '{print $2}'
  register: output

- name: get kubemanager token
  shell: kubectl describe secret "{{ output.stdout }}" -n contrail  | grep -i 'token:' | awk '{print $2}'
  register: output

- name: set kubemanager token
  set_fact:
    kubemanagertoken: "{{ output.stdout }}"

- debug:
   msg: "{{ kubemanagertoken }}"
